/*! symbol 07-11-2014 */
!function(a){var b=function(a,b,c){this.x=a,this.y=b,this.id=c};b.prototype.distanceTo=function(a){var b=a.x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},b.prototype.clone=function(){return new b(this.x,this.y,this.id)},b.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},b.prototype.subtract=function(a){return this.x-=a.x,this.y-=a.y,this},b.prototype.divide=function(a){return this.x/=a,this.y/=a,this};var c=function(a,c){this.resolution=32,this.name=a,this.originalPoints=c.slice(0),this.points=[];for(var d=0;d<c.length;d++)for(var e=0;e<c[d].length;e++)this.points.push(new b(c[d][e][0],c[d][e][1],d));this.points=this.resample(),this.points=this.scale(),this.points=this.translateTo(new b(0,0,0))};c.prototype.resample=function(){for(var a=this.points,c=this.pathLength()/(this.resolution-1),d=0,e=new Array(a[0]),f=1;f<a.length;f++)if(a[f].id==a[f-1].id){var g=a[f-1].distanceTo(a[f]);if(d+g>=c){var h=a[f-1].x+(c-d)/g*(a[f].x-a[f-1].x),i=a[f-1].y+(c-d)/g*(a[f].y-a[f-1].y),j=new b(h,i,a[f].id);e[e.length]=j,a.splice(f,0,j),d=0}else d+=g}return e.length==this.resolution-1&&(e[e.length]=new b(a[a.length-1].x,a[a.length-1].y,a[a.length-1].id)),e},c.prototype.pathLength=function(){for(var a=0,b=1;b<this.points.length;b++)this.points[b].id==this.points[b-1].id&&(a+=this.points[b-1].distanceTo(this.points[b]));return a},c.prototype.scale=function(){for(var a=[],c=new b(+1/0,+1/0,0),d=new b(-1/0,-1/0,0),e=0;e<this.points.length;e++)c.x=Math.min(c.x,this.points[e].x),c.y=Math.min(c.y,this.points[e].y),d.x=Math.max(d.x,this.points[e].x),d.y=Math.max(d.y,this.points[e].y);for(var f=Math.max(d.x-c.x,d.y-c.y),e=0;e<this.points.length;e++)a.push(this.points[e].clone().subtract(c).divide(f));return a},c.prototype.translateTo=function(a){for(var b=[],c=this.centroid(),d=a.clone().subtract(c),e=0,f=this.points.length;f>e;e++)b.push(this.points[e].clone().add(d));return b},c.prototype.centroid=function(){for(var a=new b(0,0,0),c=0;c<this.points.length;c++)a.x+=this.points[c].x,a.y+=this.points[c].y;return a.x/=this.points.length,a.y/=this.points.length,a},c.prototype.distanceTo=function(a,b){var c,d,e,f,g,h=0,i=this.points.length,j=b,k=[],l=-1,m=+1/0;for(d=0;i>d;d++)k[d]=!1;do{for(l=-1,m=+1/0,c=0,e=k.length;e>c;c++)k[c]||(g=this.points[j].distanceTo(a.points[c]),m>g&&(m=g,l=c));k[l]=!0,f=1-(j-b+i)%i/i,h+=f*m,j=(j+1)%i}while(j!=b);return h};var d=function(){this.pointClouds=[],this.listeners={},this.registerEvents(document)};d.prototype.registerEvents=function(a){var b=!1,c=[],d=0,e=this;a.addEventListener("mousedown",function(){b=!0,c=[],d++}),a.addEventListener("mousemove",function(a){b&&c.push([a.offsetX,a.offsetY])}),a.addEventListener("mouseup",function(){b=!1,e.recognize([c])})},d.prototype.on=function(a,b){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.recognize=function(a){if(!(a[0].length<=1)){for(var b=new c("user",a),d=+1/0,e=-1,f=0;f<this.pointClouds.length;f++){var g=this.greedyCloudMatch(b,this.pointClouds[f]);d>g&&(d=g,e=f)}var h=this.pointClouds[e].name,i=Math.max((d-2)/-2,0);if(0>=i)return!1;if(this.listeners[h])for(var f=0;f<this.listeners[h].length;f++)this.listeners[h][f](i)}},d.prototype.add=function(a,b){this.pointClouds.push(new c(a,b))},d.prototype.greedyCloudMatch=function(a,b){var c,d,e,f=a.points.length,g=Math.floor(Math.pow(f,.5)),h=+1/0;for(c=0;f>c;c+=g)d=a.distanceTo(b,c),e=b.distanceTo(a,c),h=Math.min(h,Math.min(d,e));return h},a.Symbol=new d}(window);
